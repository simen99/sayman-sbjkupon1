<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SlotBangJago - Cari Kupon Luckyspin</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0b0f;
      --panel:#12121a;
      --gold:#f4c542;
      --gold2:#d6a400;
      --text:#e9e9ef;
      --muted:#a5a5b5;
      --ok:#21d07a;
      --err:#ff5c7a;
      --ring: 0 0 0 2px rgba(244,197,66,.25), 0 8px 30px rgba(244,197,66,.15);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Poppins,system-ui,Segoe UI,Roboto,Arial;
      background: radial-gradient(1200px 600px at 10% -10%, rgba(244,197,66,.06), transparent 60%),
                  radial-gradient(1200px 600px at 90% 110%, rgba(244,197,66,.06), transparent 60%),
                  var(--bg);
      color:var(--text);
    }
    .wrap{max-width:980px; margin:0 auto; padding:32px 16px 64px;}
    .hero{display:flex; gap:18px; align-items:center; justify-content:space-between; flex-wrap:wrap; margin-bottom:18px;}
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 12px; border-radius:999px;
      background:linear-gradient(180deg, rgba(244,197,66,.15), rgba(244,197,66,.05));
      border:1px solid rgba(244,197,66,.25);
      color:var(--gold);
      box-shadow:var(--ring);
      font-weight:600; letter-spacing:.2px;
    }
    .title{
      font-size: clamp(22px, 3vw, 34px);
      font-weight:800; line-height:1.1;
      background: linear-gradient(180deg, #fff, #c9c9d6 55%, #9a9ab0);
      -webkit-background-clip: text; background-clip:text; color:transparent; 
      text-shadow: 0 0 12px rgba(244,197,66,.08);
      margin: 6px 0 2px;
    }
    .subtitle{color:var(--muted); margin:0 0 18px}
    .panel{
      background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.06);
      border-radius:18px; padding:16px;
      box-shadow: 0 10px 40px rgba(0,0,0,.4), inset 0 1px 0 rgba(255,255,255,.03);
    }
    .searchbar{display:grid; grid-template-columns: 1fr auto; gap:12px; align-items:center;}
    .input{
      width:100%; background:#0e0e15;
      border:1px solid rgba(255,255,255,.08);
      border-radius:14px; color:var(--text);
      padding:14px 16px; font-size:16px; outline:none;
      transition:.2s border, .2s box-shadow, .2s transform;
      box-shadow: inset 0 2px 8px rgba(0,0,0,.35);
    }
    .input:focus{border-color: rgba(244,197,66,.55); box-shadow: var(--ring); transform: translateY(-1px);}
    .btn{
      position:relative; overflow:hidden;
      appearance:none; border:0; cursor:pointer;
      background: linear-gradient(180deg, var(--gold), var(--gold2));
      color:#1a1a1a; font-weight:800; letter-spacing:.3px;
      padding:14px 18px; border-radius:14px; min-width:140px; 
      transition: transform .08s ease, filter .2s ease;
      box-shadow: 0 10px 30px rgba(244,197,66,.25);
    }
    .btn:hover{filter:brightness(1.06)}
    .btn:active{transform: translateY(1px) scale(.99)}
    .btn .dot{
      position:absolute; inset:0;
      background: radial-gradient(300px 120px at var(--x,50%) var(--y,50%), rgba(255,255,255,.35), transparent 40%);
      pointer-events:none; mix-blend-mode:soft-light;
    }
    .btn .spinner{
      width:16px; height:16px; border-radius:50%;
      border:2px solid rgba(0,0,0,.18); border-top-color:#000;
      display:inline-block; vertical-align:-3px;
      animation: spin 1s linear infinite; margin-right:8px;
    }
    @keyframes spin{to{transform: rotate(360deg)}}
    .section{margin-top:18px}
    .hint{color:var(--muted); font-size:13px; margin-top:8px}
    .skeleton{border-radius:14px; background: linear-gradient(90deg, rgba(255,255,255,.06), rgba(255,255,255,.02) 40%, rgba(255,255,255,.06));
      background-size: 600px 100%; animation: shimmer 1.2s infinite; height: 110px; margin-top:12px;}
    @keyframes shimmer{0%{background-position:-600px 0}100%{background-position:600px 0}}
    .card{background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.025));
      border:1px solid rgba(255,255,255,.08); border-radius:18px; padding:16px; margin-top:12px;}
    .grid{display:grid; gap:12px; grid-template-columns: repeat(3, 1fr);}
    .kv{background:#0e0e15; border:1px solid rgba(255,255,255,.06); border-radius:12px; padding:12px; min-height:64px; position:relative;}
    .kv label{display:block; font-size:12px; color:var(--muted); margin-bottom:6px}
    .kv .val{font-weight:700; letter-spacing:.2px}
    .copy-btn{
  display:inline-flex; align-items:center; gap:6px;
  font-size:14px; font-weight:700;
  background:linear-gradient(180deg, var(--gold), var(--gold2));
  color:#1a1a1a; border:0; border-radius:999px;
  padding:8px 16px; cursor:pointer;
  /* hilangkan glow tebal: */
  box-shadow: 0 1px 0 rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.25);
  transition: transform .12s ease, filter .15s ease;
}
.copy-btn:hover{ filter:brightness(1.04); transform:translateY(-1px); }
.copy-btn:active{ transform:translateY(0) scale(.98); }
.copy-btn::before{ content:"üìã"; font-size:14px; }
    
    .status{display:inline-flex; align-items:center; gap:6px; font-size:12px; padding:6px 10px; border-radius:999px;
      border:1px solid rgba(33,208,122,.4); color:#bff7da; background:rgba(33,208,122,.1);}
    .status.err{border-color:rgba(255,92,122,.5); color:#ffd0da; background:rgba(255,92,122,.1)}
    .toast{position:fixed; right:16px; bottom:16px; z-index:9999; display:flex; flex-direction:column; gap:10px;}
    .toast-item{padding:12px 14px; border-radius:12px; font-size:14px; background:#171722; color:#f2f2f8;
      border:1px solid rgba(255,255,255,.08); display:flex; align-items:center; gap:10px;}
    footer{margin-top:36px; color:var(--muted); font-size:12px; text-align:center}
    @media (max-width: 720px){.grid{grid-template-columns:1fr} .btn{min-width:120px}}
    
.table thead th {
  background: #15151f;
  color: #f4c542;
  font-weight: 700;
  padding: 12px;
  text-align: center;
  border-bottom: 1px solid rgba(255,255,255,.15);
}

.table tbody td {
  padding: 12px;
  border-bottom: 1px solid rgba(255,255,255,.08); /* garis tipis antar baris */
}

.table tbody tr:last-child td {
  border-bottom: none; /* hapus garis terakhir */
}

.table tbody tr:hover {
  background: rgba(255,255,255,.03);
}

.btn:disabled{
  opacity:.7;
  cursor:not-allowed;
  filter: grayscale(.1) brightness(.95);
  transform:none;
}

.wa-btn{
  display:inline-block;
  background:linear-gradient(180deg,#25d366,#128c7e);
  color:#fff;
  font-weight:700;
  padding:10px 18px;
  border-radius:999px;
  text-decoration:none;
  transition:all .2s ease;
  box-shadow:0 2px 8px rgba(0,0,0,.25);
}
.wa-btn:hover{ filter:brightness(1.08); transform:translateY(-1px); }
.wa-btn:active{ transform:scale(.96); }

/* Tombol X ‚Äî lebih besar, tetap tanpa background */
.popup-close{
  position:absolute; top:10px; right:12px;
  width:46px; height:46px; border:none; background:transparent;
  color:#fff; font-size:28px; font-weight:700;   /* ‚ùó lebih tebal */
  line-height:46px; cursor:pointer;
  text-shadow:0 2px 10px rgba(0,0,0,.7), 0 0 8px rgba(255,255,255,.45);
  z-index:2;
}
.popup-close:hover{ transform: scale(1.08); }

/* Dots tetap di tengah, tidak bergerak */
.popup-dots{
  position:absolute; left:0; right:0; bottom:14px;
  display:flex; gap:12px; align-items:center; justify-content:center; z-index:2;
}
.popup-dot{
  width:14px; height:14px; border-radius:999px;
  background: rgba(255,255,255,.4);
  box-shadow:0 0 6px rgba(255,255,255,.35);
  transition: transform .25s, background .25s, box-shadow .25s;
  cursor:pointer;                      /* bisa di-klik */
}
/* Dot aktif: emas + pulse halus di dalam titik */
.popup-dot.active{
  background: var(--gold);
  box-shadow: 0 0 14px rgba(244,197,66,.9), 0 0 24px rgba(244,197,66,.6);
  transform: scale(1.25);
}
.popup-dot.active::after{
  content:""; position:absolute; inset:0; border-radius:inherit;
  background: rgba(244,197,66,.35);
  animation: dotPulse 1.2s ease-out infinite;
}

@keyframes dotPulse{
  0%   { transform: scale(.6); opacity:.9; }
  70%  { transform: scale(1.6); opacity:.2; }
  100% { transform: scale(1.8); opacity:0; }
}

/* kecilkan tombol close di layar kecil */
@media (max-width:420px){
  .popup-close{ width:38px; height:38px; font-size:22px; line-height:38px; }
}

/* Backdrop popup ‚Äî fixed & hidden sampai .open */
.modal-backdrop{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(2px);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 999999;
}
.modal-backdrop.open{ display: flex; }

/* bungkus popup: hilangkan height fixed di CSS, biar JS yang set */
.popup-wrap{
  position:relative;
  width:600px;              /* default desktop */
  /* height:347px;  <-- HAPUS baris fixed height */
  max-width:92vw;           /* responsif */
  border:3px solid var(--gold);
  border-radius:18px; overflow:hidden;
  box-shadow:0 20px 50px rgba(0,0,0,.55), 0 0 0 5px rgba(244,197,66,.28) inset;
  background:#000;
}

/* efek fade saat ganti gambar */
.popup-img.fadeout{ opacity: 0; }

/* gambar utuh (tidak ter-crop) di layar kecil */
.popup-img{
  width:100%; height:100%;
  object-fit: contain;      /* <‚Äî was cover */
  background:#000;          /* bar hitam letterbox */
  display:block;
  opacity:1; transition:opacity .6s ease;
}

@media (max-width: 480px){
  .popup-close{ width:38px; height:38px; font-size:22px; line-height:38px; }
  .popup-dots{ bottom:10px; gap:10px; }
  .popup-dot{ width:12px; height:12px; }
}

/* ===== mobile polish & compatibility ===== */
html { -webkit-text-size-adjust: 100%; text-size-adjust: 100%; }
body { padding-bottom: calc(90px + env(safe-area-inset-bottom)); } /* ruang utk bubble chat/notch */

.wrap { max-width: 980px; }

/* fallback kalau browser tua tak paham clamp() */
.title { font-size: 26px; }
@media (min-width:480px){ .title { font-size: 30px; } }
@media (min-width:720px){ .title { font-size: 34px; } }

/* Panel & grid */
.panel { border-radius: 14px; }
.subtitle { line-height: 1.45; }

/* input: cegah auto-zoom iOS, perbesar tap area */
.input {
  font-size: 16px;      /* 16px penting supaya iOS tidak zoom */
  min-height: 48px;
  border-radius: 12px;
}

/* tombol cari: full-width di mobile, tebal & nyaman ditekan */
.btn {
  min-height: 48px;
  border-radius: 12px;
}
@media (max-width: 560px){
  .hero { justify-content: center; }
  .wrap { padding: 24px 14px 100px; }       /* ruang bawah utk chat bubble */
  .panel { padding: 14px; }
  .searchbar { grid-template-columns: 1fr; gap: 10px; }
  .btn { width: 100%; }
}

/* hasil/table: bisa digeser horizontal & tetap rapi */
.card {
  overflow-x: hidden;   /* matikan scroll horizontal */
}

.table {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;      /* kolom otomatis rapat ke dalam container */
}

.table thead th, 
.table tbody td {
  padding: 10px;
  word-wrap: break-word;    /* pecah kata panjang agar tetap muat */
  white-space: normal;      /* biar teks boleh turun ke bawah */
  text-align: center;       /* rata tengah biar elegan */
}

/* prefer reduced motion: kurangi transisi untuk user sensitif */
@media (prefers-reduced-motion: reduce) {
  * { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important; scroll-behavior: auto !important; }
}

    /* --- Poles tampilan hasil di mobile --- */
@media (max-width: 560px){

  /* Sembunyikan header tabel, kita ganti dengan label per kolom */
  .table thead{ display:none; }

  .table{ border-radius:14px; border:0; }
  .table tbody{ display:block; }

  .table tbody tr{
    display:block;
    background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.025));
    border:1px solid rgba(255,255,255,.08);
    border-radius:14px;
    padding:12px;
    margin:12px 0;
    box-shadow: 0 6px 18px rgba(0,0,0,.25);
  }

  .table tbody td{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:10px;
    border:0 !important;            /* hilangkan garis2 tabel */
    padding:8px 0;                   /* rapikan ritme */
    text-align:left;
  }

  /* Label kecil di sisi kiri setiap field */
  .table tbody td::before{
    content: attr(data-label);
    flex:0 0 auto;
    color: var(--muted);
    font-size:12px;
    font-weight:600;
    letter-spacing:.2px;
    text-transform:uppercase;
    margin-right:10px;
  }

  /* Nilai di kanan, boleh turun baris jika panjang */
  .table tbody td > *{ flex:1 1 auto; }

  /* Kode: jangan pecah karakter & gunakan mono agar ‚Äúkotak‚Äù */
  .code-val{
    white-space:nowrap;
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-weight:800;
    letter-spacing:.4px;
  }

  /* Tombol copy berubah chip di sebelah kode */
  .copy-btn{
    flex:0 0 auto;
    padding:8px 14px;
    box-shadow:0 2px 10px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.25);
  }
}

@media (max-width:560px){
  .table tbody td[data-label="Kode"]{ gap:12px; }
  .table tbody td[data-label="Kode"] .code-val{ min-width:0; }
  .table tbody td[data-label="Kode"] .copy-btn{ flex:0 0 auto; }
}

    .play-btn {
  display: block;
  margin: 18px auto 0;
  max-width: 280px;
  text-align: center;
  background: linear-gradient(180deg, var(--gold), var(--gold2));
  color: #1a1a1a;
  font-weight: 800;
  font-size: 16px;
  padding: 14px 18px;
  border-radius: 14px;
  text-decoration: none;   /* Hapus garis hitam */
  box-shadow: 0 10px 30px rgba(244,197,66,.25);
  transition: transform .12s ease, filter .15s ease;
}
.play-btn:hover { filter: brightness(1.06); transform: translateY(-1px); }
.play-btn:active { transform: scale(.98); }

    /* ==== Versi Mobile Header Elegan ==== */
@media (max-width: 560px){
  .hero {
    justify-content: center;
    width: 100%;
    margin-bottom: 6px;
  }
  .badge {
    margin: 4px auto 6px;
    font-size: 13px;
    padding: 6px 12px;
    border: 1px solid rgba(244,197,66,.4);
    box-shadow: 0 0 12px rgba(244,197,66,.25);
    display: inline-block;
    position: relative;
  }
  .badge::after {
    content: "";
    position: absolute;
    bottom: -6px; left: 50%;
    transform: translateX(-50%);
    width: 60%;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--gold), transparent);
    border-radius: 999px;
  }

  .title {
    text-align: center;
    font-size: 22px;
    margin: 4px 0 4px;
  }

  .subtitle {
    text-align: center;
    font-size: 14px;
    line-height: 1.4;
    margin: 0 0 6px;
    padding: 0 10px;
  }
}

.floating-buttons {
  position: fixed;
  bottom: 80px;   /* naik sedikit agar tidak menabrak livechat */
  left: 12px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  z-index: 9999;
}

.floating-buttons .float-btn img {
  width: 54px;
  height: 54px;
  border-radius: 50%;
  box-shadow: 0 4px 12px rgba(0,0,0,.45);
  transition: transform 0.2s ease;
}

.floating-buttons .float-btn img:hover {
  transform: scale(1.12);
}

/* ===== Loading Skeleton ‚Äî clean + classy ===== */
.skeleton{
  position: relative;
  height: 120px;
  margin-top:12px;
  border-radius:14px;
  background: #12121a;                      /* panel gelap solid */
  border:1px solid rgba(255,255,255,.06);
  overflow:hidden;
  box-shadow: 0 12px 36px rgba(0,0,0,.4),    /* drop shadow lembut */
              inset 0 1px 0 rgba(255,255,255,.04),
              inset 0 0 0 1px rgba(255,255,255,.03); /* ring tipis */
}

/* ‚Äúaurora shimmer‚Äù elegan ‚Äî tanpa bayangan putih pekat */
.skeleton::before{
  content:"";
  position:absolute; inset:-20% -60%;        /* lebih besar biar halus */
  background:
    radial-gradient(60% 40% at 20% 30%, rgba(255,255,255,.05), transparent 60%),
    radial-gradient(50% 30% at 80% 70%, rgba(255,255,255,.04), transparent 60%),
    linear-gradient(100deg, transparent 0%, rgba(255,255,255,.06) 50%, transparent 100%);
  transform: translateX(-40%);
  filter: blur(6px);
  animation: sk-aurora 1.6s ease-in-out infinite;
}
@keyframes sk-aurora{
  0%   { transform: translateX(-40%) }
  100% { transform: translateX(40%) }
}

/* Bar placeholder (teks palsu) ‚Äî kontras pas */
.sk-bar{
  height: 12px;
  border-radius: 8px;
  background: rgba(255,255,255,.06);
  margin: 10px 14px;
  animation: sk-pulse 1.8s ease-in-out infinite;
}
.sk-bar:nth-child(1){ width:48%;  margin-top:18px; }
.sk-bar:nth-child(2){ width:76%;  animation-delay:.1s; }
.sk-bar:nth-child(3){ width:62%;  animation-delay:.2s; }

@keyframes sk-pulse{
  0%,100%{ opacity:.55 }
  50%   { opacity:.95 }
}

/* ===== Slider tipis 955 x 115 ===== */
.mini-slider{
  position:relative;
  max-width:955px;                 /* lebar target */
  height:115px;                    /* tinggi target di desktop */
  margin:14px auto 0;
  border-radius:14px;
  overflow:hidden;
  background:linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
  border:1px solid rgba(255,255,255,.06);
  box-shadow:0 10px 30px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.03);
}
@media (max-width: 980px){
  /* skala proporsional di mobile */
  .mini-slider{ height:auto; aspect-ratio: 955 / 115; }
}

.ms-track{
  width:100%; height:100%;
  display:flex; transition:transform .45s ease;
  will-change: transform;
}

.ms-slide{
  flex:0 0 100%; width:100%; height:100%;
}
.ms-slide a, .ms-slide img{
  display:block; width:100%; height:100%;
}
.ms-slide img{ object-fit:cover; }

/* dots */
.ms-dots{
  position:absolute; left:0; right:0; bottom:8px;
  display:flex; gap:8px; justify-content:center; align-items:center;
  pointer-events:auto;
}
.ms-dot{
  width:10px; height:10px; border-radius:999px;
  background:rgba(255,255,255,.45);
  border:1px solid rgba(0,0,0,.25);
  box-shadow:0 0 6px rgba(255,255,255,.25);
  cursor:pointer; transition:transform .2s, background .2s;
}
.ms-dot.active{
  background:var(--gold);
  transform:scale(1.25);
  box-shadow:0 0 12px rgba(244,197,66,.8);
}
    
  </style>
  
</head>
<body>
  <div class="wrap">
    <div class="hero"><span class="badge">SlotBangJago - Cari Kupon Lucksypin</span></div>
    <h1 class="title">Cari Kupon & Validasi User ID</h1>
    <p class="subtitle">Masukkan <b>USER ID</b> aktif kamu. Jika cocok, sistem akan menampilkan semua kupon luckyspin kamu.‚ú®</p>

    <div class="panel">
      <div class="searchbar">
        <input id="q" class="input" placeholder="Contoh: sempak234"
       autocomplete="off" autocapitalize="off" spellcheck="false" inputmode="text" />
        <button id="go" class="btn"><span class="label">üîé Cari</span><span class="dot"></span></button>
      </div>
      <div class="hint">Tekan <b>Enter</b> atau klik <b>Cari</b>.</div>
    </div>

    <!-- SLIDER TIPIS -->
<div class="mini-slider" id="miniSlider" aria-label="Promo Slider">
  <div class="ms-track" id="msTrack"></div>
  <!-- dot navigasi -->
  <div class="ms-dots" id="msDots"></div>
</div>

    <div id="loading" class="skeleton" style="display:none;"></div>
    <div id="result" class="section"></div>
    <footer>¬© 2015 - <span id="y"></span> Copyright SLOTBANGJAGO. All Rights Reserved.</footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
  <div class="toast" id="toast"></div>

  <script>
  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwCXASjddyikXRJnwpfYdXlt0CQu6aBHMzWI0tjlSJneCw2BbbBNpy_ojQhPlxZPHP7aw/exec";

  const $ = (s,ctx=document)=>ctx.querySelector(s);
  const el = (tag, cls)=>{const n=document.createElement(tag); if(cls) n.className=cls; return n;};
  const fmtDate = (s)=>{const d=new Date(s); if(String(d)==="Invalid Date") return s||"-";
    return d.toLocaleString("id-ID",{day:"2-digit",month:"long",year:"numeric"});};
  const toast=(msg,ok=true)=>{const box=$("#toast");const t=el("div","toast-item");
    t.innerHTML=ok?`‚úÖ ${msg}`:`‚ùå ${msg}`;box.appendChild(t);
    setTimeout(()=>{t.style.opacity="0";setTimeout(()=>t.remove(),300);},2500);};

  $("#y").textContent=new Date().getFullYear();
  $("#q").addEventListener("keydown",(e)=>{if(e.key==="Enter") search();});
  $("#go").addEventListener("click",()=>search());

  let busy = false;

  function setLoading(v){
  const box = $("#loading");
  if(v){
    box.style.display = "block";
    box.innerHTML = `
      <div class="sk-bar"></div>
      <div class="sk-bar"></div>
      <div class="sk-bar"></div>
    `;
    // kasih random delay/arah tiap skeleton
    box.querySelectorAll(".sk-bar").forEach(bar=>{
      const dir = Math.random() > 0.5 ? "normal" : "reverse"; // arah random
      const speed = (1.5 + Math.random()).toFixed(2);         // 1.5s ‚Äì 2.5s
      bar.style.animationDirection = dir;
      bar.style.animationDuration = speed+"s";
    });
  } else {
    box.style.display = "none";
    box.innerHTML = "";
  }
}

  async function search(){
  if (busy) return;           // <-- hard block anti-spam
  const q = $("#q").value.trim();
  $("#result").innerHTML = "";
  if(!q){ toast("Isi User ID dulu ya", false); return; }
  if(!WEB_APP_URL.includes("http")){ toast("WEB_APP_URL belum diisi", false); return; }

  busy = true;
  setLoading(true);
  try{
    const res = await fetch(WEB_APP_URL + "?searchtext=" + encodeURIComponent(q));
    const data = await res.json();
    renderResult(q, Array.isArray(data) ? data : []);
  }catch(e){
    toast("Gagal konek server", false);
  }finally{
    setLoading(false);
    busy = false;
  }
}

  function escapeHTML(s){
    return String(s).replace(/[&<>"']/g, m => ({
      "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
    }[m]));
  }

function renderResult(q, rows){
  const resultBox = $("#result");
  resultBox.innerHTML = ""; // reset

  // kosong
  if (!rows.length){
    const card = el("div","card");
    card.innerHTML = `
      <div style="margin-top:4px;font-size:14px;color:var(--muted);text-align:center;">
        Pastikan User ID anda sudah benar.<br>
        Jika masih bermasalah, hubungi bantuan melalui tombol berikut:
      </div>
      <div style="margin-top:12px;text-align:center;">
        <a href="https://klikblg.com/wa-sbj" target="_blank" rel="noopener"
           class="wa-btn">üí¨ WA Official Slotbangjago</a>
      </div>`;
    resultBox.appendChild(card);
    return;
  }

  // ada data ‚Üí confetti + tabel
  confetti({ particleCount:70, spread:60, origin:{ y:0.3 } });

  const tableWrap = el("div","card");
  const table = el("table","table");
  table.innerHTML = `
    <thead><tr>
      <th>USER ID</th><th>KODE LUCKYSPIN</th><th>TANGGAL</th>
    </tr></thead>
    <tbody>${
      rows.map(r => `
        <tr>
          <td data-label="User ID">${escapeHTML(r[0])}</td>
          <td data-label="Kode">
            <span class="code-val">${escapeHTML(r[1])}</span>
            <button class="copy-btn" type="button" data-copy="${escapeHTML(r[1])}">Copy</button>
          </td>
          <td data-label="Tanggal">${escapeHTML(fmtDate(r[2]))}</td>
        </tr>`).join("")
    }</tbody>`;
  tableWrap.appendChild(table);
  resultBox.appendChild(tableWrap);

  // üëâ Tambah tombol PUTAR KUPON di bawah hasil
  const playBtn = document.createElement("a");
playBtn.href = "https://maxwinputar.com/lucky-wheel-slotbangjago/";
playBtn.target = "_blank";
playBtn.className = "play-btn";
playBtn.innerText = "üé∞ PUTAR KUPON DISINI";
resultBox.appendChild(playBtn);
}
    

// ‚úÖ listener copy global, bukan sekali pakai
function copyText(txt){
  if (navigator.clipboard && window.isSecureContext){
    return navigator.clipboard.writeText(txt);
  }
  // fallback sederhana
  const ta = document.createElement("textarea");
  ta.value = txt;
  ta.style.position = "fixed";
  ta.style.opacity = "0";
  document.body.appendChild(ta);
  ta.focus(); ta.select();
  const ok = document.execCommand("copy");
  document.body.removeChild(ta);
  return ok ? Promise.resolve() : Promise.reject();
}

document.addEventListener("click",(e)=>{
  const btn = e.target.closest(".copy-btn");
  if(!btn || !btn.dataset.copy) return;
  const txt = btn.dataset.copy;
  copyText(txt).then(()=>{
    toast("Kode disalin");
    btn.style.transform="scale(1.15)";
    btn.style.background="linear-gradient(180deg,#21d07a,#17a562)";
    setTimeout(()=>{
      btn.style.transform="scale(1)";
      btn.style.background="";
    },300);
  }).catch(()=> toast("Gagal copy", false));
});
</script>

   <!-- Popup Promo -->
<div id="promoModal" class="modal-backdrop" aria-hidden="true">
  <div class="popup-wrap" role="dialog" aria-label="Promo">
    <button class="popup-close" id="popupClose" aria-label="Tutup">‚úï</button>
    <img id="popupImg" class="popup-img" alt="Promo" />
    <div class="popup-dots">
      <span class="popup-dot"></span>
      <span class="popup-dot"></span>
    </div>
  </div>
</div>

  <script>
  // Rasio konten popup (W x H) = 600 x 347
  const POPUP_W = 600, POPUP_H = 347, POPUP_RATIO = POPUP_H / POPUP_W;

  function sizePopup() {
    const wrap = document.querySelector('.popup-wrap');
    if (!wrap) return;

    // batas lebar & tinggi layar
    const vw = Math.min(window.innerWidth, document.documentElement.clientWidth || window.innerWidth);
    const vh = Math.min(window.innerHeight, document.documentElement.clientHeight || window.innerHeight);

    // target maksimal: 92% lebar layar, 80% tinggi layar
    let maxW = Math.min(POPUP_W, vw * 0.92);
    let maxH = Math.min(POPUP_H, vh * 0.80);

    // hitung ukuran dengan menjaga rasio
    let w = maxW;
    let h = w * POPUP_RATIO;
    if (h > maxH) {            // kalau ketinggian kebanyakan, scale by height
      h = maxH;
      w = h / POPUP_RATIO;
    }

    wrap.style.width  = Math.round(w) + 'px';
    wrap.style.height = Math.round(h) + 'px';
  }

  // panggil saat DOM siap, saat buka popup, dan saat resize
  document.addEventListener('DOMContentLoaded', sizePopup);
  window.addEventListener('resize', sizePopup);

  // kalau kamu punya fungsi openPromo, panggil juga di sana:
  // setelah modal.classList.add('open');
  // sizePopup();
</script>

  <script>
  // ====== Popup Promo ======
  const PROMO_IMAGES = [
    "https://raw.githubusercontent.com/simen99/Kode-luckyspin-slotbangjago1/refs/heads/main/luckyspin%20sbj.jfif",
    "https://raw.githubusercontent.com/simen99/Kode-luckyspin-slotbangjago1/refs/heads/main/all%20bonus%20sbj.jpg"
  ];

  // preload
  PROMO_IMAGES.forEach(src => { const i=new Image(); i.src=src; });

  let idx = 0, slideTimer = null;
let modal, imgEl, btnClose, dots;

function setActiveDot(i){
  dots.forEach((d,di)=> d.classList.toggle('active', di===i));
}

function showImage(i){
  idx = i % PROMO_IMAGES.length;
  imgEl.classList.add("fadeout");
  setTimeout(()=>{
    imgEl.src = PROMO_IMAGES[idx];
    imgEl.classList.remove("fadeout");
    setActiveDot(idx);
  }, 320);
}

function openPromo(){
  idx = 0;
  imgEl.src = PROMO_IMAGES[idx];
  setActiveDot(idx);
  document.body.style.overflow = "hidden";
  modal.classList.add("open");

  sizePopup();   // <<< penting untuk set ukuran awal di mobile

  slideTimer = setInterval(()=>{ showImage(idx+1); }, 6000);
}

function closePromo(){
  modal.classList.remove("open");
  document.body.style.overflow = "";
  if (slideTimer){ clearInterval(slideTimer); slideTimer = null; }
}

// ===== INIT =====
window.addEventListener("DOMContentLoaded", () => {
  modal    = document.getElementById("promoModal");
  imgEl    = document.getElementById("popupImg");
  btnClose = document.getElementById("popupClose");
  dots     = Array.from(document.querySelectorAll(".popup-dot"));

  btnClose.addEventListener("click", closePromo);
  modal.addEventListener("click", (e)=>{ if(e.target === modal) closePromo(); });
  document.addEventListener("keydown", (e)=>{ if(e.key === "Escape") closePromo(); });

  // klik manual dot
  dots.forEach((dot,i)=>{
  dot.addEventListener("click", ()=>{
    if (slideTimer){ clearInterval(slideTimer); slideTimer=null; }
    showImage(i);
    // restart auto setelah 6 detik
    slideTimer = setInterval(()=>{ showImage(idx+1); }, 6000);
  });
});

  openPromo(); // buka otomatis
});
</script>

  <script>
/* gambar slider */
const MINI_SLIDES = [
  "https://raw.githubusercontent.com/simen99/Kode-luckyspin-slotbangjago1/refs/heads/main/slider%20luckyspin.png",
  "https://raw.githubusercontent.com/simen99/Kode-luckyspin-slotbangjago1/refs/heads/main/slider%20new%20member.png",
  "https://raw.githubusercontent.com/simen99/Kode-luckyspin-slotbangjago1/refs/heads/main/slider%20jejer.jpg"
];

(function initMiniSlider(){
  const track = document.getElementById('msTrack');
  const dotsBox = document.getElementById('msDots');
  if(!track || !dotsBox) return;

  // build slides + dots
  MINI_SLIDES.forEach((src, i)=>{
    const slide = document.createElement('div');
    slide.className = 'ms-slide';
    slide.innerHTML = `<a href="#" onclick="return false"><img src="${src}" alt="Promo ${i+1}"></a>`;
    track.appendChild(slide);

    const dot = document.createElement('span');
    dot.className = 'ms-dot';
    dotsBox.appendChild(dot);
  });

  const dots = Array.from(dotsBox.children);
  let idx = 0, timer = null;

  function goTo(i){
    idx = (i + MINI_SLIDES.length) % MINI_SLIDES.length;
    track.style.transform = `translateX(${-idx*100}%)`;
    dots.forEach((d,di)=> d.classList.toggle('active', di===idx));
  }
  function next(){ goTo(idx+1); }
  function play(){ stop(); timer = setInterval(next, 6000); }
  function stop(){ if(timer){ clearInterval(timer); timer=null; } }

  dots.forEach((d,di)=> d.addEventListener('click', ()=>{ goTo(di); play(); }));

  // pause saat hover (desktop)
  const slider = document.getElementById('miniSlider');
  slider.addEventListener('mouseenter', stop);
  slider.addEventListener('mouseleave', play);

  // basic swipe (mobile)
  let startX=0, deltaX=0, dragging=false;
  slider.addEventListener('touchstart', (e)=>{ startX=e.touches[0].clientX; deltaX=0; dragging=true; stop(); }, {passive:true});
  slider.addEventListener('touchmove', (e)=>{
    if(!dragging) return;
    deltaX = e.touches[0].clientX - startX;
    track.style.transition='none';
    track.style.transform = `translateX(${(-idx*100) + (deltaX/slider.offsetWidth)*100}%)`;
  }, {passive:true});
  function endSwipe(){
    if(!dragging) return;
    track.style.transition='';
    if(Math.abs(deltaX) > slider.offsetWidth*0.18){ deltaX<0 ? next() : goTo(idx-1); }
    else { goTo(idx); }
    dragging=false; play();
  }
  slider.addEventListener('touchend', endSwipe);
  slider.addEventListener('touchcancel', endSwipe);

  // start
  goTo(0); play();
})();
</script>
  
  <script>
    window.__lc = window.__lc || {};
    window.__lc.license = 11798511;
    window.__lc.integration_name = "manual_channels";
    window.__lc.product_name = "livechat";
    ;(function(n,t,c){
      function i(n){return e._h?e._h.apply(null,n):e._q.push(n)}
      var e={_q:[],_h:null,_v:"2.0",
        on:function(){i(["on",c.call(arguments)])},
        once:function(){i(["once",c.call(arguments)])},
        off:function(){i(["off",c.call(arguments)])},
        get:function(){if(!e._h)throw new Error("[LiveChatWidget] You can't use getters before load.");return i(["get",c.call(arguments)])},
        call:function(){i(["call",c.call(arguments)])},
        init:function(){
          var n=t.createElement("script");
          n.async=!0;
          n.type="text/javascript";
          n.src="https://cdn.livechatinc.com/tracking.js";
          t.head.appendChild(n)
        }
      };
      !n.__lc.asyncInit&&e.init(),n.LiveChatWidget=n.LiveChatWidget||e
    }(window,document,[].slice))
  </script>
  
  <noscript>
    <a href="https://www.livechat.com/chat-with/11798511/" rel="nofollow">Chat with us</a>,
    powered by <a href="https://www.livechat.com/?welcome" rel="noopener nofollow" target="_blank">LiveChat</a>
  </noscript>

  <!-- Floating Buttons -->
<div class="floating-buttons">
  <a href="https://klikblg.com/wa-sbj" target="_blank" class="float-btn">
    <img src="https://raw.githubusercontent.com/simen99/danakaget-papanataslot1/refs/heads/main/assets/whats-app.gif" alt="WhatsApp" />
  </a>
  <a href="https://klikblg.com/tele-sbj" target="_blank" class="float-btn">
    <img src="https://raw.githubusercontent.com/simen99/danakaget-papanataslot1/refs/heads/main/assets/telegram-gif.gif" alt="Telegram" />
  </a>
</div>

</body>
</html>
